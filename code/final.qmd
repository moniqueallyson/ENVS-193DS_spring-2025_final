---
title: "final"
format: html
---

[Github link](https://github.com/moniqueallyson/ENVS-193DS_spring-2025_final)

```{r, message=FALSE}

library(tidyverse)
library(janitor)
library(lubridate)
library(readr)
setwd("/Users/moniquehernandez/Desktop/ENVS-193DS/assignment/ENVS-139DS-FINAL/ENVS-193DS_spring-2025_final")
sst <- read_csv("data/SST_update2023.csv")


```

# Problem 1. Research writing

## a. Transparent statistical methods

In part 1, they used a correlation test, specifically Pearson's r, since they measured the strength and direction of two variables which in this case are two continuous variables distance from headwater(km) and annual total nitrogen load (kg year^-1^).

In part 2, thy used a one-way ANOVA test because the report compares the average nitrogen load across more than two groups: urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands.

## b. More information needed

1. It would be helpful to do a post-hoc test like Tukey's HSD as it can determine which groups are different from each other while the ANOVA test signified that there is a difference in the average nitrogen load (kg year⁻¹) between sources (p = 0.02). The Tukey's HSD will be able to compare the groups to each other (fertilizer vs. grasslands, urban land vs. atmospheric deposition), which will determine which pairs of groups have significantly different mean nitrogen loads.
e
2. It could also be helpful to use effect size, such as eta-squared (η²), which measures the proportion of variation explained in nitrogen load (kg year⁻¹) from the five different sources. This means that it quantifies the portion of variance explained by sources. The interpretation for the results can range from negligible (η² \< .01), small (.01 \< η² \< .06), medium (.06 \< η² \< .14), and large (η² \> .14).

## c. Suggestions for rewriting

Part 1: There is a relationship between distance from headwater (km) and annual total nitrogen load (kg year⁻¹), suggesting that nitrogen load varies with distance. We rejected the null hypothesis that there is no correlation between these variables (Pearson’s r = [correlation coefficient], p = 0.03, α = 0.05).

Part2: A difference in the average nitrogen load (kg year⁻¹) in the San Joaquin River Delta was found between the five sources (urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands), with an effect size (η² = effect size value) indicating that the proportion of variance explained by source type. This suggests that these sources contribute to variation in nitrogen load in the river delta. (One-way ANOVA; F(4, df₂) = F-value, p = 0.02, α = 0.05)

# Problem 2. Data visualization

## a. Cleaning and summarizing

```{r}
library(readr)
sst_clean <- read_csv("/Users/moniquehernandez/Desktop/ENVS-193DS/assignment/ENVS-139DS-FINAL/ENVS-193DS_spring-2025_final/data/SST_update2023.csv")

library(tidyverse)
library(lubridate)

sst_clean <- sst |>                     
  mutate(                               
    date = ymd(date),                   # date column is in date format
    year = year(date),                 # year from date
    month = month(date, label = TRUE)  # extract months
  ) |>
  filter(year >= 1982, year <= 2023) |> # Filter year range 1982-2023
  group_by(year, month) |>             # group by year and month
  summarize(
    mean_monthly_sst = mean(temp, na.rm = TRUE) # average for temperature
  ) |>
  ungroup()

# Display a random sample of 5 rows
sst_clean |> slice_sample(n = 5)

# Show the structure of the cleaned data
str(sst_clean)

```


## b. Visualize the data

```{r}
library(ggplot2)

# Filter the data for 2018 to 2023
sst_clean |> 
  filter(year >= 2018, year <= 2023)

# custom purple palete for scale color manual
purple_palette <- c(
  "2018" = "#E6E6FA",
  "2019" = "#D8BFD8",
  "2020" = "#DDA0DD",
  "2021" = "#DA70D6",
  "2022" = "#BA55D3",
  "2023" = "#8A2BE2"
)

# Plot
ggplot(sst_subset, aes(x = month, y = mean_monthly_sst, group = factor(year), color = factor(year))) +
  geom_line(size = 1) +                  # First geom line
  geom_point(size = 2) +                 # Second geom points
  scale_color_manual(                   # Use custom purple scale color
    values = purple_palette,
    name = "Year"
  ) +
  labs(
    x = "Month", # x axis as month
    y = "Mean Monthly Sea Surface Temperature (°C)", # y axis as m
    title = "Monthly Sea Surface Temperature (2018–2023)"
  ) +
  theme_minimal() +
  theme(
    legend.position = c(0.15, 0.65),     # Inside panel to the left and lowered to avoid blocking
    panel.border = element_rect(color = "black", fill = NA, size = 1),
    panel.background = element_rect(fill = "white")
  )


```


# Problem 3. Data analysis

## a. Response variable

## b. Purpose of study

## c. Difference in “seasons”

## d. Table of models

## e. Run the models

## f. Check the diagnostics

## g. Select the best model

## h. Visualize the model predictions

## i. Write a caption for your figure.

## j. Calculate model predictions

## k. Interpret your results

# Problem 4. Affective and exploratory visualizations

## a. Comparing visualizations

## b. Sharing your affective visualization
